--- mythburn/mythtvburn.sh	2006-03-22 23:18:37.000000000 -0500
+++ mythburn/mythtvburn.sh	2006-03-22 00:11:37.000000000 -0500
@@ -587,7 +590,8 @@
 #Convert menu PNGs to JPGs
 for file in ${tempdir}/output*.png
 do
-	convert -quality 100 $file ${file}.jpg
+#	convert -quality 100 $file ${file}.jpg
+	convert -quality 100 $file ${file}.ppm
 	checkreturnvalue
 	rm $file
 done
@@ -607,11 +611,14 @@
 then
 #Create 60 frames for the menu page
 #-a is aspect ratio 2=4:3 3=16:9 4=2.21:1
-nice jpeg2yuv -v 0 -n 60 -I p -f $framerate -j \
-	${tempdir}/output${page}.png.jpg | \
-	nice mpeg2enc -q 2 -a 2 -v 0 -n p -f 8 \
-	-o ${tempdir}/background.m2v
-checkreturnvalue
+#nice jpeg2yuv -v 0 -n 60 -I p -f $framerate -j \
+#	${tempdir}/output${page}.png.jpg | \
+#	nice mpeg2enc -q 2 -a 2 -v 0 -n p -f 8 \
+#	-o ${tempdir}/background.m2v
+#checkreturnvalue
+
+nice ppmtoy4m -I p -r -n 60 -S 420jpeg ${tempdir}/output${page}.png.ppm \
+ | nice mpeg2enc -q 2 -a 2 -v 0 -n p -f 8 -o ${tempdir}/background.m2v
 
 fi
 
@@ -657,8 +664,8 @@
 
 while [ $imageindex -lt $maxanimframes ]
 do
-	filename=`printf "V%06d.jpg" $imageindex`
 
+	filename=`printf "V%06d.jpg" $imageindex`        
 #echo $filename
 
 	if [ $numofimagefolders = 4 ];
@@ -669,7 +676,7 @@
      		-draw "image Over ${xpos},${row3} 0,0 '${tempdir}/${page}_3/${filename}'" \
      		-draw "image Over ${xpos},${row4} 0,0 '${tempdir}/${page}_4/${filename}'" \
      		-antialias \
-     		${tempdir}/output${page}.png.jpg ${tempdir}/menu/${page}_${filename}.jpg
+     		${tempdir}/output${page}.png.ppm ${tempdir}/menu/${page}_${filename}.ppm
 	checkreturnvalue
 
      	fi
@@ -681,7 +688,7 @@
      		-draw "image Over ${xpos},${row2} 0,0 '${tempdir}/${page}_2/${filename}'" \
      		-draw "image Over ${xpos},${row3} 0,0 '${tempdir}/${page}_3/${filename}'" \
      		-antialias \
-     		${tempdir}/output${page}.png.jpg ${tempdir}/menu/${page}_${filename}.jpg
+     		${tempdir}/output${page}.png.ppm ${tempdir}/menu/${page}_${filename}.ppm
 	checkreturnvalue
      	fi
 
@@ -691,7 +698,7 @@
      		-draw "image Over ${xpos},${row1} 0,0 '${tempdir}/${page}_1/${filename}'" \
      		-draw "image Over ${xpos},${row2} 0,0 '${tempdir}/${page}_2/${filename}'" \
      		-antialias \
-     		${tempdir}/output${page}.png.jpg ${tempdir}/menu/${page}_${filename}.jpg
+     		${tempdir}/output${page}.png.ppm ${tempdir}/menu/${page}_${filename}.ppm
 	checkreturnvalue
      	fi
 
@@ -700,7 +707,7 @@
 	nice convert \
      		-draw "image Over ${xpos},${row1} 0,0 '${tempdir}/${page}_1/${filename}'" \
      		-antialias \
-     		${tempdir}/output${page}.png.jpg ${tempdir}/menu/${page}_${filename}.jpg
+     		${tempdir}/output${page}.png.ppm ${tempdir}/menu/${page}_${filename}.ppm
      	checkreturnvalue
      	fi
 
@@ -721,8 +728,9 @@
 	checkstopflag
 
 	echo Converting movie to MPEG2
-	nice jpeg2yuv -v 0 -I p -f $framerate -j ${tempdir}/menu/${page}_V%06d.jpg.jpg | \
-    			nice mpeg2enc -q 2 -a 2 -v 0 -n p -f 8 -o ${tempdir}/background.m2v
+	ls ${tempdir}/menu/${page}_V*.jpg.ppm | nice xargs -n1 cat | \
+		nice ppmtoy4m -I p -n $framerate -S 420jpeg | \
+    		nice mpeg2enc -q 2 -a 2 -v 0 -n p -f 8 -o ${tempdir}/background.m2v
 	checkreturnvalue
 
 	rm -dfr ${tempdir}/${page}_1
@@ -744,7 +752,7 @@
 nice spumux -m dvd -s 0 ${tempdir}/tempspumux${page}.xml < ${tempdir}/tempmenu$page.mpg > ${tempdir}/menu$page.mpg
 checkreturnvalue
 
-rm -f ${tempdir}/output${page}.png.jpg
+rm -f ${tempdir}/output${page}.png.ppm
 rm -f ${tempdir}/select${page}.png
 rm -f ${tempdir}/tempmenu${page}.mpg
 rm -f ${tempdir}/background.m2v
--- mythburn/scripts/createintro.sh	2006-03-23 00:54:14.000000000 -0500
+++ mythburn/scripts/createintro.sh	2006-03-22 00:11:37.000000000 -0500
@@ -62,16 +61,21 @@
 checkreturnvalue
 
 echo "Convert intro image to JPG"
-nice convert -quality 100 ${tempdir}/intro${index}.png ${tempdir}/intro${index}.jpg
+nice convert -quality 100 ${tempdir}/intro${index}.png ${tempdir}/intro${index}.ppm
 checkreturnvalue
 
 echo "Encode intro image to mpg movie"
 #Create 200 frames for the menu page: -a is aspect ratio 2=4:3 3=16:9 4=2.21:1
-nice jpeg2yuv -v 0 -n 200 -I p -f $framerate -j \
-	${tempdir}/intro${index}.jpg | \
-	nice mpeg2enc -q 5 -a $aspectRatio -v 0 -n p -f 8 \
-	-o ${tempdir}/intro$index.m2v
-checkreturnvalue
+#nice jpeg2yuv -v 0 -n 200 -I p -f $framerate -j \
+#	${tempdir}/intro${index}.jpg | \
+#	nice mpeg2enc -q 5 -a 2 -v 0 -n p -f 8 \
+#	-o ${tempdir}/intro$index.m2v
+#checkreturnvalue
+
+nice ppmtoy4m  -r -n 200 -S 420jpeg ${tempdir}/intro${index}.ppm \
+ | nice mpeg2enc -q 5 -a 2 -v 0 -n p -f 8 \
+  -o ${tempdir}/intro$index.m2v
+
 
 echo "Multiplexing the intro and music together"
 nice mplex -f 8 -v 0 -o ${tempdir}/intro$index.mpg ${tempdir}/intro$index.m2v ${myfolder}/music/silence.mp2
@@ -79,7 +83,7 @@
 
 #Tidy up
 #rm ${tempdir}/intro${index}.mpg
-rm ${tempdir}/intro${index}.jpg
+rm ${tempdir}/intro${index}.ppm
 rm ${tempdir}/intro$index.m2v
 rm ${tempdir}/intro${index}.png
 
